(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{164:function(e,t,r){},170:function(e,t,r){"use strict";r.r(t);var n=r(0),o=r.n(n),s=r(23),a=r.n(s);r(34),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c=r(17),l=r(18),i=r(21),u=r(19),d=r(20),v=r(9),h=r.n(v),p=r(26),f=r.n(p),m=r(25),g=r.n(m),y=r(42),w=r.n(y);function _(e){return o.a.createElement("div",null,"Resource ",e.name)}function E(e){var t=e.resources.map(function(e){return o.a.createElement("li",{key:e.props.id},e)});return o.a.createElement("ul",null,t)}var b=r(40),R=r.n(b),k=r(60),x=r.n(k),S=r(44);function C(e){var t=[];if(0===e.events.length)return o.a.createElement(R.a,{className:"instruction-list"});var r=!0,n=!1,s=void 0;try{for(var a,c=function(){var r=a.value,n=S.findIndex(e.events,r),s=n===e.eventCounter;t.push(o.a.createElement(x.a,{button:!0,className:"event-item",onClick:function(t){return e.clickHandler(n)},selected:s},n,") ",r.process_id," ",r.operation," ",r.resource_id))},l=e.events[Symbol.iterator]();!(r=(a=l.next()).done);r=!0)c()}catch(i){n=!0,s=i}finally{try{r||null==l.return||l.return()}finally{if(n)throw s}}return o.a.createElement(R.a,{className:"instruction-list"},t)}function O(e){return o.a.createElement("div",null,"Process ",e.name)}function D(e){var t=function(e,t){var r=e.props.owner,n=e.props.waiting;return t.props.id===r?"Owner":n.includes(t.props.id)?"Waiting":"Request"}(e.resource,e.process),r="default";return"owner"===t.toLowerCase()?r="primary":"waiting"===t.toLowerCase()&&(r="secondary"),o.a.createElement("td",null,o.a.createElement(g.a,{variant:"outlined",color:r,className:"resource-acquire-button",onClick:function(t){return e.onClick(e.process.props.id,e.resource.props.id,t)}},t))}function q(e){var t=e.processes.map(function(e){return o.a.createElement("li",{key:e.props.id},e," - ",e.props.blocked?"Blocked":"Running")});return o.a.createElement("ul",null,t)}var I=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(i.a)(this,Object(u.a)(t).call(this,e))).clear=function(){var e=document.getElementById("graph-space");if(null===e)return!1;e.getContext("2d").clearRect(0,0,e.width,e.height)},r.state={count:1},r.canvas_height=405,r.canvas_width=800,r.title="Resource Management Graph",r.title_row=40,r.title_col=r.canvas_width/2,r.text_padding_top=8,r.process_height=30,r.process_width=50,r.process_row=300,r.resource_height=30,r.resource_width=50,r.resource_row=100,r}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=document.getElementById("graph-space"),t=null;if(null===e)return o.a.createElement("div",null);t=e.getContext("2d"),e.width=this.canvas_width,e.height=this.canvas_height,this.clear();var r=this.props.processes.length,n=this.props.resources.length;t.font="30px Consolas",t.fillStyle="black",t.textAlign="center",t.strokeStyle="black",t.fillText(this.title,this.title_col,this.title_row),t.font="16px Consolas";for(var s=parseInt(e.width/r),a=0;a<r;a++){var c=a*s+.5*(s-this.process_width),l=a*s+.5*s,i=this.process_row+.5*this.process_height+this.text_padding_top;t.rect(c,this.process_row,this.process_width,this.process_height),t.stroke(),t.fillText("p"+a,l,i)}for(var u=parseInt(e.width/n),d=0;d<n;d++){var v=d*u+.5*(u-this.resource_width),h=d*u+.5*u,p=this.resource_row+.5*this.resource_height+this.text_padding_top;t.rect(v,this.resource_row,this.resource_width,this.resource_height),t.stroke(),t.fillText("r"+d,h,p)}for(var f=.5*s,m=.5*u,g=0;g<n;g++){var y=this.props.resources[g].owner,w=this.props.resources[g].waiting;if(null!==y&&(t.beginPath(),t.strokeStyle="green",t.moveTo(y*s+f,this.process_row),t.lineTo(g*u+m,this.resource_row+this.resource_height),t.stroke(),w.length>0)){var _=!0,E=!1,b=void 0;try{for(var R,k=w[Symbol.iterator]();!(_=(R=k.next()).done);_=!0){var x=R.value;t.beginPath(),t.strokeStyle="red",t.moveTo(x*s+f,this.process_row),t.lineTo(g*u+m,this.resource_row+this.resource_height),t.stroke()}}catch(S){E=!0,b=S}finally{try{_||null==k.return||k.return()}finally{if(E)throw b}}}}return o.a.createElement("div",null)}}]),t}(o.a.Component),N=r(61),j=r.n(N),P=r(63),T=r.n(P),B=r(33),F=r.n(B),H=r(62),M=r.n(H),W=r(41),A=r.n(W);function J(e){var t=e.processes,r=e.resources,n=e.processOnClick,s=r.map(function(e){return o.a.createElement(F.a,{key:e.props.id},o.a.createElement(_,{id:e.props.id,name:e.props.name}))}),a=t.map(function(e){var t=[];t.push(o.a.createElement(F.a,null,o.a.createElement(O,{id:e.props.id,name:e.props.name})));var s=!0,a=!1,c=void 0;try{for(var l,i=r[Symbol.iterator]();!(s=(l=i.next()).done);s=!0){var u=l.value;t.push(o.a.createElement(D,{process:e,resource:u,onClick:n}))}}catch(d){a=!0,c=d}finally{try{s||null==i.return||i.return()}finally{if(a)throw c}}return o.a.createElement(A.a,{key:e.props.id},t)});return o.a.createElement(j.a,null,o.a.createElement(M.a,null,o.a.createElement(A.a,null,o.a.createElement(F.a,null),s)),o.a.createElement(T.a,null,a))}var L=r(24),G=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(i.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=e.fileChangeHandler.bind(Object(L.a)(Object(L.a)(r))),r.fileInput=o.a.createRef(),r}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return o.a.createElement("form",{onChange:this.handleSubmit},o.a.createElement("input",{type:"file",ref:this.fileInput}))}}]),t}(o.a.Component),U=(r(164),r(44));function $(e){return o.a.createElement("p",null,e.deadlocked.join(","))}var z=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(i.a)(this,Object(u.a)(t).call(this,e))).nextEvent=function(e){e.preventDefault();var t=r.state.resource_event_counter;if(t>=r.state.resource_events.length-1)return!1;if(r.state.resource_history.length>t+1)return r.goToEventNumber(t+1),void r.setState(function(e){return{resource_event_counter:t+1}});var n=r.state.resource_events[t+1];if("requests"===n.operation)r.requestResource(n.process_id,n.resource_id);else{if("releases"!==n.operation)return console.log("ERROR: Unknown resource operation found."),!1;r.releaseResource(n.process_id,n.resource_id)}r.state.resource_history.length>=t&&r.saveResourceManagerState(),r.setState(function(e){return{resource_event_counter:t+1}})},r.prevEvent=function(){var e=r.state.resource_event_counter;if(!(e<0)){if(0===e){var t=U.cloneDeep(r.state.resources),n=[],o=!0,s=!1,a=void 0;try{for(var c,l=t[Symbol.iterator]();!(o=(c=l.next()).done);o=!0){var i=c.value;i.owner=null,i.waiting=[],n.push(i)}}catch(u){s=!0,a=u}finally{try{o||null==l.return||l.return()}finally{if(s)throw a}}r.setState(function(e){return{resources:n}})}else r.goToEventNumber(e-1);r.setState(function(t){return{resource_event_counter:e-1}})}},r.goToEventNumber=function(e){console.log("Reloading from event number "+e),r.setState(function(t){return{processes:r.state.resource_history[e].processes,resources:r.state.resource_history[e].resources,resource_event_counter:e}})},r.saveResourceManagerState=function(){var e=r.state.resource_event_counter;console.log("Saving state for event number "+e);var t=U.cloneDeep(r.state.resource_history),n={processes:U.cloneDeep(r.state.processes),resources:U.cloneDeep(r.state.resources)};t[e]=U.cloneDeep(n),r.setState(function(e){return{resource_history:t}})},r.fileChangeHandler=function(e){e.preventDefault();var t=e.target.files[0],n=new FileReader;n.onload=function(e){console.log(e.target.result);var t=e.target.result.split("\n"),n=!0,o=!1,s=void 0;try{for(var a,c=t[Symbol.iterator]();!(n=(a=c.next()).done);n=!0){var l=a.value;l.includes("processes")?function(){var e=l.match(/(\d+) processes/)[1];console.log("Found "+e+" processes.");for(var t=[],n=0;n<e;n++)t.push({id:n,name:"p"+n});r.setState(function(e){return{processes:t}})}():l.includes("resources")?function(){var e=l.match(/(\d+) resources/)[1];console.log("Found "+e+" resources.");for(var t=[],n=0;n<e;n++)t.push({id:n,name:"r"+n,owner:null,waiting:[]});r.setState(function(e){return{resources:t}})}():l.includes("requests")?function(){var e=l.match(/p(\d+) requests r(\d+)/),t=parseInt(e[1]),n=parseInt(e[2]);console.log("Found resource request line: p"+t+" => r"+n);var o=U.cloneDeep(r.state.resource_events),s={process_id:t,resource_id:n,operation:"requests"};o.push(s),r.setState(function(e){return{resource_events:o}})}():l.includes("releases")?function(){var e=l.match(/p(\d+) releases r(\d+)/),t=parseInt(e[1]),n=parseInt(e[2]);console.log("Found resource release line: p"+t+" => r"+n);var o=U.cloneDeep(r.state.resource_events),s={process_id:t,resource_id:n,operation:"releases"};o.push(s),r.setState(function(e){return{resource_events:o}})}():console.log("ERROR: Found line which doesn't match standard.")}}catch(i){o=!0,s=i}finally{try{n||null==c.return||c.return()}finally{if(o)throw s}}};n.readAsText(t)},r.getNextProcessId=function(e){if(0===e.length)return 0;var t=0,r=!0,n=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done);r=!0){var c=s.value;c.id>=t&&(t=c.id+1)}}catch(l){n=!0,o=l}finally{try{r||null==a.return||a.return()}finally{if(n)throw o}}return t},r.addProcess=function(e,t){var n=U.cloneDeep(r.state.processes);null===e&&(e=r.getNextProcessId(n)),null===t&&(t="unspecified");var o={id:e,name:t};n.push(o),r.setState(function(e){return{resources:n}})},r.removeProcess=function(e){if(null===e)return!1;var t=U.cloneDeep(r.state.processes),n={id:e};U.remove(t,n),r.setState(function(e){return{processes:t}})},r.checkForDeadlock=function(){var e=r.state.resources,t=!0,n=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(t=(s=a.next()).done);t=!0){var c=s.value;if(null!==c.owner&&r.cycleDetector(c.id,[],"p"+c.owner))return!0}}catch(l){n=!0,o=l}finally{try{t||null==a.return||a.return()}finally{if(n)throw o}}return!1},r.cycleDetector=function(e,t,n){if(console.log("Cycle Detecting: "+e),console.log("Cycle array: "+t),t.includes(n))return console.log("Deadlock detected: "+t),r.deadlock=t,!0;var o=r.state.resources,s=o[e],a=!0,c=!1,l=void 0;try{for(var i,u=s.waiting[Symbol.iterator]();!(a=(i=u.next()).done);a=!0){var d=i.value,v=!0,h=!1,p=void 0;try{for(var f,m=o[Symbol.iterator]();!(v=(f=m.next()).done);v=!0){var g=f.value;if(g.owner===d){var y=t;if(y.push("p"+d),y.push("r"+g.id),console.log("Calling Cycle Detector"),r.cycleDetector(g.id,y,n))return!0}}}catch(w){h=!0,p=w}finally{try{v||null==m.return||m.return()}finally{if(h)throw p}}}}catch(w){c=!0,l=w}finally{try{a||null==u.return||u.return()}finally{if(c)throw l}}return!1},r.getResourceById=function(e,t){var r=!0,n=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done);r=!0){var c=s.value;if(c.id===t)return c}}catch(l){n=!0,o=l}finally{try{r||null==a.return||a.return()}finally{if(n)throw o}}return null},r.handleRequestClick=function(e,t,n){var o=r.state.resources,s=r.getResourceById(o,t);if(null===s||-1===s)return console.log("ERROR: Resource ["+t+"] requested by process ["+e+"], but not present."),!1;s.waiting.includes(e)||s.owner===e?r.releaseResource(e,t):r.requestResource(e,t)},r.requestResource=function(e,t){var n=U.cloneDeep(r.state.resources),o=r.getResourceById(n,t),s=U.findIndex(r.state.resources,o);if(null===o||-1===s)return console.log("ERROR: Resource ["+t+"] requested, but not present."),!1;var a=o.owner,c=o.waiting;return console.log("Process "+e+" is requesting Resource "+t),null===a?(n[s].owner=e,console.log("Resource is free!"),r.setState(function(e){return{resources:n}}),!0):a!==e?c.includes(e)?(console.log("ERROR: Process duplicate resource request."),!1):(n[s].waiting.push(e),console.log("Process joining the wait queue..."),r.setState(function(e){return{resources:n}}),!1):void console.log("Process "+e+" requesting resource it already owns! ("+t+")")},r.releaseResource=function(e,t){var n=U.cloneDeep(r.state.resources),o=r.getResourceById(n,t),s=U.findIndex(r.state.resources,o);if(null===o||-1===s)return console.log("ERROR: Resource ["+t+"] requested, but not present."),!1;var a=o.owner,c=o.waiting;if(a===e){var l=c.shift();return n[s].owner=void 0===l?null:l,n[s].waiting=c,r.setState(function(e){return{resources:n}}),!0}return console.log("ERROR: Process("+e+") tried to release a resource("+o.id+") without ownership."),!1},r.getProcessState=function(e){var t=r.state.resources,n=!0,o=!1,s=void 0;try{for(var a,c=t[Symbol.iterator]();!(n=(a=c.next()).done);n=!0){if(a.value.waiting.includes(e))return!0}}catch(l){o=!0,s=l}finally{try{n||null==c.return||c.return()}finally{if(o)throw s}}return!1},r.state={processes:[],resources:[],resource_events:[],resource_history:[],resource_event_counter:-1},r.deadlock=[],r}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=[],t=[],r=!0,n=!1,s=void 0;try{for(var a,c=this.state.resources[Symbol.iterator]();!(r=(a=c.next()).done);r=!0){var l=a.value;e.push(o.a.createElement(_,{id:l.id,name:l.name,owner:l.owner,waiting:l.waiting}))}}catch(y){n=!0,s=y}finally{try{r||null==c.return||c.return()}finally{if(n)throw s}}var i=!0,u=!1,d=void 0;try{for(var v,p=this.state.processes[Symbol.iterator]();!(i=(v=p.next()).done);i=!0){var m=v.value;t.push(o.a.createElement(O,{id:m.id,name:m.name,blocked:this.getProcessState(m.id),owner:m.owner,waiting:m.waiting,clickHandler:this.requestResource}))}}catch(y){u=!0,d=y}finally{try{i||null==p.return||p.return()}finally{if(u)throw d}}return o.a.createElement(h.a,{className:"full-display",container:!0,direction:"column",spacing:12},o.a.createElement(h.a,{className:"main-panel",container:!0,spacing:12},o.a.createElement(h.a,{item:!0,xs:3,xm:3,xl:3},o.a.createElement(f.a,null,o.a.createElement("div",{className:"instruction-panel"},o.a.createElement("div",{className:"instruction-file-section"},o.a.createElement(G,{fileChangeHandler:this.fileChangeHandler})),o.a.createElement(w.a,null),o.a.createElement("div",{className:"instruction-section"},o.a.createElement(C,{events:this.state.resource_events,clickHandler:this.goToEventNumber,eventCounter:this.state.resource_event_counter})),o.a.createElement(w.a,null),o.a.createElement(h.a,{container:!0,xs:12,spacing:12},o.a.createElement(h.a,{xs:6},o.a.createElement(g.a,{variant:"outlined",className:"instruction-nav-button",disabled:-1===this.state.resource_event_counter,onClick:this.prevEvent},"Previous")),o.a.createElement(h.a,{xs:6},o.a.createElement(g.a,{variant:"outlined",className:"instruction-nav-button",disabled:this.state.resource_event_counter===this.state.resource_events.length-1,onClick:this.nextEvent},-1===this.state.resource_event_counter?"Start":"Next")))))),o.a.createElement(h.a,{item:!0,xs:9,xm:9,xl:9},o.a.createElement(f.a,null,o.a.createElement("canvas",{id:"graph-space"}),o.a.createElement(I,{resources:this.state.resources,processes:this.state.processes})))),o.a.createElement(h.a,{className:"debug-panel",container:!0,spacing:12},o.a.createElement(h.a,{item:!0,xs:3},o.a.createElement(f.a,null,o.a.createElement("div",null,o.a.createElement("h2",null,this.checkForDeadlock()?"Deadlock found:":"No deadlock."),o.a.createElement($,{deadlocked:this.deadlock})),o.a.createElement("div",null,o.a.createElement("h2",null,"Processes"),o.a.createElement(q,{processes:t})),o.a.createElement("div",null,o.a.createElement("h2",null,"Resources"),o.a.createElement(E,{resources:e})))),o.a.createElement(h.a,{item:!0,xs:9},o.a.createElement(f.a,null,o.a.createElement(J,{resources:e,processes:t,processOnClick:this.handleRequestClick})))))}}]),t}(o.a.Component);a.a.render(o.a.createElement(z,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},34:function(e,t,r){},64:function(e,t,r){e.exports=r(170)}},[[64,2,1]]]);
//# sourceMappingURL=main.001b3067.chunk.js.map