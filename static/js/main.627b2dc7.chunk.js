(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{26:function(e,t,r){},33:function(e,t,r){e.exports=r(47)},45:function(e,t,r){},47:function(e,t,r){"use strict";r.r(t);var n=r(0),o=r.n(n),a=r(9),s=r.n(a);r(26),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c=r(11),i=r(12),u=r(16),l=r(13),f=r(17),d=r(79),h=r(80),p=r(73),v=r(81);function m(e){return o.a.createElement("div",null,"Resource ",e.name)}function g(e){var t=e.resources.map(function(e){return o.a.createElement("li",{key:e.props.id},e)});return o.a.createElement("ul",null,t)}var y=r(71),w=r(83);function b(e,t){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"===typeof e)return _(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return _(e,t)}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function _(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var E=r(28);function S(e){var t=[];if(0===e.events.length)return o.a.createElement(y.a,{className:"instruction-list"});var r,n=b(e.events);try{var a=function(){var n=r.value,a=E.findIndex(e.events,n),s=a===e.eventCounter;t.push(o.a.createElement(w.a,{button:!0,className:"event-item",onClick:function(t){return e.clickHandler(a)},selected:s},a,") ",n.process_id," ",n.operation," ",n.resource_id))};for(n.s();!(r=n.n()).done;)a()}catch(s){n.e(s)}finally{n.f()}return o.a.createElement(y.a,{className:"instruction-list"},t)}function R(e){return o.a.createElement("div",null,"Process ",e.name)}function k(e){var t=function(e,t){var r=e.props.owner,n=e.props.waiting;return t.props.id===r?"Owner":n.includes(t.props.id)?"Waiting":"Request"}(e.resource,e.process),r="default";return"owner"===t.toLowerCase()?r="primary":"waiting"===t.toLowerCase()&&(r="secondary"),o.a.createElement("td",null,o.a.createElement(p.a,{variant:"outlined",color:r,className:"resource-acquire-button",onClick:function(t){return e.onClick(e.process.props.id,e.resource.props.id,t)}},t))}function x(e){var t=e.processes.map(function(e){return o.a.createElement("li",{key:e.props.id},e," - ",e.props.blocked?"Blocked":"Running")});return o.a.createElement("ul",null,t)}function O(e,t){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"===typeof e)return C(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return C(e,t)}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var I=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).clear=function(){var e=document.getElementById("graph-space");if(null===e)return!1;e.getContext("2d").clearRect(0,0,e.width,e.height)},r.state={count:1},r.canvas_height=405,r.canvas_width=800,r.title="Resource Management Graph",r.title_row=40,r.title_col=r.canvas_width/2,r.text_padding_top=8,r.process_height=30,r.process_width=50,r.process_row=300,r.resource_height=30,r.resource_width=50,r.resource_row=100,r}return Object(f.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=document.getElementById("graph-space"),t=null;if(null===e)return o.a.createElement("div",null);t=e.getContext("2d"),e.width=this.canvas_width,e.height=this.canvas_height,this.clear();var r=this.props.processes.length,n=this.props.resources.length;t.font="30px Consolas",t.fillStyle="black",t.textAlign="center",t.strokeStyle="black",t.fillText(this.title,this.title_col,this.title_row),t.font="16px Consolas";for(var a=parseInt(e.width/r),s=0;s<r;s++){var c=s*a+.5*(a-this.process_width),i=s*a+.5*a,u=this.process_row+.5*this.process_height+this.text_padding_top;t.rect(c,this.process_row,this.process_width,this.process_height),t.stroke(),t.fillText("p"+s,i,u)}for(var l=parseInt(e.width/n),f=0;f<n;f++){var d=f*l+.5*(l-this.resource_width),h=f*l+.5*l,p=this.resource_row+.5*this.resource_height+this.text_padding_top;t.rect(d,this.resource_row,this.resource_width,this.resource_height),t.stroke(),t.fillText("r"+f,h,p)}for(var v=.5*a,m=.5*l,g=0;g<n;g++){var y=this.props.resources[g].owner,w=this.props.resources[g].waiting;if(null!==y&&(t.beginPath(),t.strokeStyle="green",t.moveTo(y*a+v,this.process_row),t.lineTo(g*l+m,this.resource_row+this.resource_height),t.stroke(),w.length>0)){var b,_=O(w);try{for(_.s();!(b=_.n()).done;){var E=b.value;t.beginPath(),t.strokeStyle="red",t.moveTo(E*a+v,this.process_row),t.lineTo(g*l+m,this.resource_row+this.resource_height),t.stroke()}}catch(S){_.e(S)}finally{_.f()}}}return o.a.createElement("div",null)}}]),t}(o.a.Component),j=r(76),A=r(78),D=r(74),q=r(77),N=r(75);function P(e,t){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"===typeof e)return T(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return T(e,t)}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function T(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function B(e){var t=e.processes,r=e.resources,n=e.processOnClick,a=r.map(function(e){return o.a.createElement(D.a,{key:e.props.id},o.a.createElement(m,{id:e.props.id,name:e.props.name}))}),s=t.map(function(e){var t=[];t.push(o.a.createElement(D.a,null,o.a.createElement(R,{id:e.props.id,name:e.props.name})));var a,s=P(r);try{for(s.s();!(a=s.n()).done;){var c=a.value;t.push(o.a.createElement(k,{process:e,resource:c,onClick:n}))}}catch(i){s.e(i)}finally{s.f()}return o.a.createElement(N.a,{key:e.props.id},t)});return o.a.createElement(j.a,null,o.a.createElement(q.a,null,o.a.createElement(N.a,null,o.a.createElement(D.a,null),a)),o.a.createElement(A.a,null,s))}var F=r(20),H=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).handleSubmit=e.fileChangeHandler.bind(Object(F.a)(Object(F.a)(r))),r.fileInput=o.a.createRef(),r}return Object(f.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return o.a.createElement("form",{onChange:this.handleSubmit},o.a.createElement("input",{type:"file",ref:this.fileInput}))}}]),t}(o.a.Component);r(45);function M(e,t){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"===typeof e)return U(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return U(e,t)}(e))||t&&e&&"number"===typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,s=!0,c=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return s=e.done,e},e:function(e){c=!0,a=e},f:function(){try{s||null==r.return||r.return()}finally{if(c)throw a}}}}function U(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var $=r(28);function W(e){return o.a.createElement("p",null,e.deadlocked.join(","))}var J=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(u.a)(this,Object(l.a)(t).call(this,e))).nextEvent=function(e){e.preventDefault();var t=r.state.resource_event_counter;if(t>=r.state.resource_events.length-1)return!1;if(r.state.resource_history.length>t+1)return r.goToEventNumber(t+1),void r.setState(function(e){return{resource_event_counter:t+1}});var n=r.state.resource_events[t+1];if("requests"===n.operation)r.requestResource(n.process_id,n.resource_id);else{if("releases"!==n.operation)return console.log("ERROR: Unknown resource operation found."),!1;r.releaseResource(n.process_id,n.resource_id)}r.state.resource_history.length>=t&&r.saveResourceManagerState(),r.setState(function(e){return{resource_event_counter:t+1}})},r.prevEvent=function(){var e=r.state.resource_event_counter;if(!(e<0)){if(0===e){var t,n=$.cloneDeep(r.state.resources),o=[],a=M(n);try{for(a.s();!(t=a.n()).done;){var s=t.value;s.owner=null,s.waiting=[],o.push(s)}}catch(c){a.e(c)}finally{a.f()}r.setState(function(e){return{resources:o}})}else r.goToEventNumber(e-1);r.setState(function(t){return{resource_event_counter:e-1}})}},r.goToEventNumber=function(e){console.log("Reloading from event number "+e),r.setState(function(t){return{processes:r.state.resource_history[e].processes,resources:r.state.resource_history[e].resources,resource_event_counter:e}})},r.saveResourceManagerState=function(){var e=r.state.resource_event_counter;console.log("Saving state for event number "+e);var t=$.cloneDeep(r.state.resource_history),n={processes:$.cloneDeep(r.state.processes),resources:$.cloneDeep(r.state.resources)};t[e]=$.cloneDeep(n),r.setState(function(e){return{resource_history:t}})},r.fileChangeHandler=function(e){e.preventDefault();var t=e.target.files[0],n=new FileReader;n.onload=function(e){console.log(e.target.result);var t,n=M(e.target.result.split("\n"));try{for(n.s();!(t=n.n()).done;){var o=t.value;o.includes("processes")?function(){var e=o.match(/(\d+) processes/)[1];console.log("Found "+e+" processes.");for(var t=[],n=0;n<e;n++)t.push({id:n,name:"p"+n});r.setState(function(e){return{processes:t}})}():o.includes("resources")?function(){var e=o.match(/(\d+) resources/)[1];console.log("Found "+e+" resources.");for(var t=[],n=0;n<e;n++)t.push({id:n,name:"r"+n,owner:null,waiting:[]});r.setState(function(e){return{resources:t}})}():o.includes("requests")?function(){var e=o.match(/p(\d+) requests r(\d+)/),t=parseInt(e[1]),n=parseInt(e[2]);console.log("Found resource request line: p"+t+" => r"+n);var a=$.cloneDeep(r.state.resource_events),s={process_id:t,resource_id:n,operation:"requests"};a.push(s),r.setState(function(e){return{resource_events:a}})}():o.includes("releases")?function(){var e=o.match(/p(\d+) releases r(\d+)/),t=parseInt(e[1]),n=parseInt(e[2]);console.log("Found resource release line: p"+t+" => r"+n);var a=$.cloneDeep(r.state.resource_events),s={process_id:t,resource_id:n,operation:"releases"};a.push(s),r.setState(function(e){return{resource_events:a}})}():console.log("ERROR: Found line which doesn't match standard.")}}catch(a){n.e(a)}finally{n.f()}};n.readAsText(t)},r.getNextProcessId=function(e){if(0===e.length)return 0;var t,r=0,n=M(e);try{for(n.s();!(t=n.n()).done;){var o=t.value;o.id>=r&&(r=o.id+1)}}catch(a){n.e(a)}finally{n.f()}return r},r.addProcess=function(e,t){var n=$.cloneDeep(r.state.processes);null===e&&(e=r.getNextProcessId(n)),null===t&&(t="unspecified");var o={id:e,name:t};n.push(o),r.setState(function(e){return{resources:n}})},r.removeProcess=function(e){if(null===e)return!1;var t=$.cloneDeep(r.state.processes),n={id:e};$.remove(t,n),r.setState(function(e){return{processes:t}})},r.checkForDeadlock=function(){var e,t=M(r.state.resources);try{for(t.s();!(e=t.n()).done;){var n=e.value;if(null!==n.owner&&r.cycleDetector(n.id,[],"p"+n.owner))return!0}}catch(o){t.e(o)}finally{t.f()}return!1},r.cycleDetector=function(e,t,n){if(console.log("Cycle Detecting: "+e),console.log("Cycle array: "+t),t.includes(n))return console.log("Deadlock detected: "+t),r.deadlock=t,!0;var o,a=r.state.resources,s=M(a[e].waiting);try{for(s.s();!(o=s.n()).done;){var c,i=o.value,u=M(a);try{for(u.s();!(c=u.n()).done;){var l=c.value;if(l.owner===i){var f=t;if(f.push("p"+i),f.push("r"+l.id),console.log("Calling Cycle Detector"),r.cycleDetector(l.id,f,n))return!0}}}catch(d){u.e(d)}finally{u.f()}}}catch(d){s.e(d)}finally{s.f()}return!1},r.getResourceById=function(e,t){var r,n=M(e);try{for(n.s();!(r=n.n()).done;){var o=r.value;if(o.id===t)return o}}catch(a){n.e(a)}finally{n.f()}return null},r.handleRequestClick=function(e,t,n){var o=r.state.resources,a=r.getResourceById(o,t);if(null===a||-1===a)return console.log("ERROR: Resource ["+t+"] requested by process ["+e+"], but not present."),!1;a.waiting.includes(e)||a.owner===e?r.releaseResource(e,t):r.requestResource(e,t)},r.requestResource=function(e,t){var n=$.cloneDeep(r.state.resources),o=r.getResourceById(n,t),a=$.findIndex(r.state.resources,o);if(null===o||-1===a)return console.log("ERROR: Resource ["+t+"] requested, but not present."),!1;var s=o.owner,c=o.waiting;return console.log("Process "+e+" is requesting Resource "+t),null===s?(n[a].owner=e,console.log("Resource is free!"),r.setState(function(e){return{resources:n}}),!0):s!==e?c.includes(e)?(console.log("ERROR: Process duplicate resource request."),!1):(n[a].waiting.push(e),console.log("Process joining the wait queue..."),r.setState(function(e){return{resources:n}}),!1):void console.log("Process "+e+" requesting resource it already owns! ("+t+")")},r.releaseResource=function(e,t){var n=$.cloneDeep(r.state.resources),o=r.getResourceById(n,t),a=$.findIndex(r.state.resources,o);if(null===o||-1===a)return console.log("ERROR: Resource ["+t+"] requested, but not present."),!1;var s=o.owner,c=o.waiting;if(s===e){var i=c.shift();return n[a].owner=void 0===i?null:i,n[a].waiting=c,r.setState(function(e){return{resources:n}}),!0}return console.log("ERROR: Process("+e+") tried to release a resource("+o.id+") without ownership."),!1},r.getProcessState=function(e){var t,n=M(r.state.resources);try{for(n.s();!(t=n.n()).done;){if(t.value.waiting.includes(e))return!0}}catch(o){n.e(o)}finally{n.f()}return!1},r.state={processes:[],resources:[],resource_events:[],resource_history:[],resource_event_counter:-1},r.deadlock=[],r}return Object(f.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e,t=[],r=[],n=M(this.state.resources);try{for(n.s();!(e=n.n()).done;){var a=e.value;t.push(o.a.createElement(m,{id:a.id,name:a.name,owner:a.owner,waiting:a.waiting}))}}catch(u){n.e(u)}finally{n.f()}var s,c=M(this.state.processes);try{for(c.s();!(s=c.n()).done;){var i=s.value;r.push(o.a.createElement(R,{id:i.id,name:i.name,blocked:this.getProcessState(i.id),owner:i.owner,waiting:i.waiting,clickHandler:this.requestResource}))}}catch(u){c.e(u)}finally{c.f()}return o.a.createElement(d.a,{className:"full-display",container:!0,direction:"column",spacing:12},o.a.createElement(d.a,{className:"main-panel",container:!0,spacing:12},o.a.createElement(d.a,{item:!0,xs:3,xm:3,xl:3},o.a.createElement(h.a,null,o.a.createElement("div",{className:"instruction-panel"},o.a.createElement("div",{className:"instruction-file-section"},o.a.createElement(H,{fileChangeHandler:this.fileChangeHandler})),o.a.createElement(v.a,null),o.a.createElement("div",{className:"instruction-section"},o.a.createElement(S,{events:this.state.resource_events,clickHandler:this.goToEventNumber,eventCounter:this.state.resource_event_counter})),o.a.createElement(v.a,null),o.a.createElement(d.a,{container:!0,xs:12,spacing:12},o.a.createElement(d.a,{xs:6},o.a.createElement(p.a,{variant:"outlined",className:"instruction-nav-button",disabled:-1===this.state.resource_event_counter,onClick:this.prevEvent},"Previous")),o.a.createElement(d.a,{xs:6},o.a.createElement(p.a,{variant:"outlined",className:"instruction-nav-button",disabled:this.state.resource_event_counter===this.state.resource_events.length-1,onClick:this.nextEvent},-1===this.state.resource_event_counter?"Start":"Next")))))),o.a.createElement(d.a,{item:!0,xs:9,xm:9,xl:9},o.a.createElement(h.a,null,o.a.createElement("canvas",{id:"graph-space"}),o.a.createElement(I,{resources:this.state.resources,processes:this.state.processes})))),o.a.createElement(d.a,{className:"debug-panel",container:!0,spacing:12},o.a.createElement(d.a,{item:!0,xs:3},o.a.createElement(h.a,null,o.a.createElement("div",null,o.a.createElement("h2",null,this.checkForDeadlock()?"Deadlock found:":"No deadlock."),o.a.createElement(W,{deadlocked:this.deadlock})),o.a.createElement("div",null,o.a.createElement("h2",null,"Processes"),o.a.createElement(x,{processes:r})),o.a.createElement("div",null,o.a.createElement("h2",null,"Resources"),o.a.createElement(g,{resources:t})))),o.a.createElement(d.a,{item:!0,xs:9},o.a.createElement(h.a,null,o.a.createElement(B,{resources:t,processes:r,processOnClick:this.handleRequestClick})))))}}]),t}(o.a.Component);s.a.render(o.a.createElement(J,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[33,2,1]]]);
//# sourceMappingURL=main.627b2dc7.chunk.js.map