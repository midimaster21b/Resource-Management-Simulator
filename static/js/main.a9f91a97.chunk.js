(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{164:function(e,t,r){},170:function(e,t,r){"use strict";r.r(t);var n=r(0),s=r.n(n),o=r(23),a=r.n(o);r(34),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var c=r(17),i=r(18),l=r(21),u=r(19),d=r(20),v=r(9),h=r.n(v),p=r(26),f=r.n(p),m=r(25),g=r.n(m),y=r(42),w=r.n(y);function _(e){return s.a.createElement("div",null,"Resource ",e.name)}function E(e){var t=e.resources.map(function(e){return s.a.createElement("li",{key:e.props.id},e)});return s.a.createElement("ul",null,t)}var b=r(40),R=r.n(b),x=r(60),k=r.n(x),S=r(44);function C(e){var t=[];if(0===e.events.length)return s.a.createElement(R.a,{className:"instruction-list"});var r=!0,n=!1,o=void 0;try{for(var a,c=function(){var r=a.value,n=S.findIndex(e.events,r),o=n===e.eventCounter;t.push(s.a.createElement(k.a,{button:!0,className:"event-item",onClick:function(t){return e.clickHandler(n)},selected:o},n,") ",r.process_id," ",r.operation," ",r.resource_id))},i=e.events[Symbol.iterator]();!(r=(a=i.next()).done);r=!0)c()}catch(l){n=!0,o=l}finally{try{r||null==i.return||i.return()}finally{if(n)throw o}}return s.a.createElement(R.a,{className:"instruction-list"},t)}function O(e){return s.a.createElement("div",null,"Process ",e.name)}function D(e){var t=function(e,t){var r=e.props.owner,n=e.props.waiting;return t.props.id===r?"Owner":n.includes(t.props.id)?"Waiting":"Request"}(e.resource,e.process),r="default";return"owner"===t.toLowerCase()?r="primary":"waiting"===t.toLowerCase()&&(r="secondary"),s.a.createElement("td",null,s.a.createElement(g.a,{variant:"outlined",color:r,className:"resource-acquire-button",onClick:function(t){return e.onClick(e.process.props.id,e.resource.props.id,t)}},t))}function q(e){var t=e.processes.map(function(e){return s.a.createElement("li",{key:e.props.id},e)});return s.a.createElement("ul",null,t)}var I=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(l.a)(this,Object(u.a)(t).call(this,e))).clear=function(){var e=document.getElementById("graph-space");if(null===e)return!1;e.getContext("2d").clearRect(0,0,e.width,e.height)},r.state={count:1},r.canvas_height=405,r.canvas_width=800,r.title="Resource Management Graph",r.title_row=40,r.title_col=r.canvas_width/2,r.text_padding_top=8,r.process_height=30,r.process_width=50,r.process_row=300,r.resource_height=30,r.resource_width=50,r.resource_row=100,r}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=document.getElementById("graph-space"),t=null;if(null===e)return s.a.createElement("div",null);t=e.getContext("2d"),e.width=this.canvas_width,e.height=this.canvas_height,this.clear();var r=this.props.processes.length,n=this.props.resources.length;t.font="30px Consolas",t.fillStyle="black",t.textAlign="center",t.strokeStyle="black",t.fillText(this.title,this.title_col,this.title_row),t.font="16px Consolas";for(var o=parseInt(e.width/r),a=0;a<r;a++){var c=a*o+.5*(o-this.process_width),i=a*o+.5*o,l=this.process_row+.5*this.process_height+this.text_padding_top;t.rect(c,this.process_row,this.process_width,this.process_height),t.stroke(),t.fillText("p"+a,i,l)}for(var u=parseInt(e.width/n),d=0;d<n;d++){var v=d*u+.5*(u-this.resource_width),h=d*u+.5*u,p=this.resource_row+.5*this.resource_height+this.text_padding_top;t.rect(v,this.resource_row,this.resource_width,this.resource_height),t.stroke(),t.fillText("r"+d,h,p)}for(var f=.5*o,m=.5*u,g=0;g<n;g++){var y=this.props.resources[g].owner,w=this.props.resources[g].waiting;if(null!==y&&(t.beginPath(),t.strokeStyle="green",t.moveTo(y*o+f,this.process_row),t.lineTo(g*u+m,this.resource_row+this.resource_height),t.stroke(),w.length>0)){var _=!0,E=!1,b=void 0;try{for(var R,x=w[Symbol.iterator]();!(_=(R=x.next()).done);_=!0){var k=R.value;t.beginPath(),t.strokeStyle="red",t.moveTo(k*o+f,this.process_row),t.lineTo(g*u+m,this.resource_row+this.resource_height),t.stroke()}}catch(S){E=!0,b=S}finally{try{_||null==x.return||x.return()}finally{if(E)throw b}}}}return s.a.createElement("div",null)}}]),t}(s.a.Component),N=r(61),j=r.n(N),P=r(63),T=r.n(P),B=r(33),F=r.n(B),H=r(62),M=r.n(H),W=r(41),A=r.n(W);function J(e){var t=e.processes,r=e.resources,n=e.processOnClick,o=r.map(function(e){return s.a.createElement(F.a,{key:e.props.id},s.a.createElement(_,{id:e.props.id,name:e.props.name}))}),a=t.map(function(e){var t=[];t.push(s.a.createElement(F.a,null,s.a.createElement(O,{id:e.props.id,name:e.props.name})));var o=!0,a=!1,c=void 0;try{for(var i,l=r[Symbol.iterator]();!(o=(i=l.next()).done);o=!0){var u=i.value;t.push(s.a.createElement(D,{process:e,resource:u,onClick:n}))}}catch(d){a=!0,c=d}finally{try{o||null==l.return||l.return()}finally{if(a)throw c}}return s.a.createElement(A.a,{key:e.props.id},t)});return s.a.createElement(j.a,null,s.a.createElement(M.a,null,s.a.createElement(A.a,null,s.a.createElement(F.a,null),o)),s.a.createElement(T.a,null,a))}var L=r(24),G=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(l.a)(this,Object(u.a)(t).call(this,e))).handleSubmit=e.fileChangeHandler.bind(Object(L.a)(Object(L.a)(r))),r.fileInput=s.a.createRef(),r}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return s.a.createElement("form",{onChange:this.handleSubmit},s.a.createElement("input",{type:"file",ref:this.fileInput}))}}]),t}(s.a.Component),U=(r(164),r(44)),$=function(e){function t(e){var r;return Object(c.a)(this,t),(r=Object(l.a)(this,Object(u.a)(t).call(this,e))).nextEvent=function(e){e.preventDefault();var t=r.state.resource_event_counter;if(t>=r.state.resource_events.length-1)return!1;if(r.state.resource_history.length>t+1)return r.goToEventNumber(t+1),void r.setState(function(e){return{resource_event_counter:t+1}});var n=r.state.resource_events[t+1];if("requests"===n.operation)r.requestResource(n.process_id,n.resource_id);else{if("releases"!==n.operation)return console.log("ERROR: Unknown resource operation found."),!1;r.releaseResource(n.process_id,n.resource_id)}r.state.resource_history.length>=t&&r.saveResourceManagerState(),r.setState(function(e){return{resource_event_counter:t+1}})},r.prevEvent=function(){var e=r.state.resource_event_counter;if(!(e<0)){if(0===e){var t=U.cloneDeep(r.state.resources),n=[],s=!0,o=!1,a=void 0;try{for(var c,i=t[Symbol.iterator]();!(s=(c=i.next()).done);s=!0){var l=c.value;l.owner=null,l.waiting=[],n.push(l)}}catch(u){o=!0,a=u}finally{try{s||null==i.return||i.return()}finally{if(o)throw a}}r.setState(function(e){return{resources:n}})}else r.goToEventNumber(e-1);r.setState(function(t){return{resource_event_counter:e-1}})}},r.goToEventNumber=function(e){console.log("Reloading from event number "+e),r.setState(function(t){return{processes:r.state.resource_history[e].processes,resources:r.state.resource_history[e].resources,resource_event_counter:e}})},r.saveResourceManagerState=function(){var e=r.state.resource_event_counter;console.log("Saving state for event number "+e);var t=U.cloneDeep(r.state.resource_history),n={processes:U.cloneDeep(r.state.processes),resources:U.cloneDeep(r.state.resources)};t[e]=U.cloneDeep(n),r.setState(function(e){return{resource_history:t}})},r.fileChangeHandler=function(e){e.preventDefault();var t=e.target.files[0],n=new FileReader;n.onload=function(e){console.log(e.target.result);var t=e.target.result.split("\n"),n=!0,s=!1,o=void 0;try{for(var a,c=t[Symbol.iterator]();!(n=(a=c.next()).done);n=!0){var i=a.value;i.includes("processes")?function(){var e=i.match(/(\d+) processes/)[1];console.log("Found "+e+" processes.");for(var t=[],n=0;n<e;n++)t.push({id:n,name:"p"+n});r.setState(function(e){return{processes:t}})}():i.includes("resources")?function(){var e=i.match(/(\d+) resources/)[1];console.log("Found "+e+" resources.");for(var t=[],n=0;n<e;n++)t.push({id:n,name:"r"+n,owner:null,waiting:[]});r.setState(function(e){return{resources:t}})}():i.includes("requests")?function(){var e=i.match(/p(\d+) requests r(\d+)/),t=parseInt(e[1]),n=parseInt(e[2]);console.log("Found resource request line: p"+t+" => r"+n);var s=U.cloneDeep(r.state.resource_events),o={process_id:t,resource_id:n,operation:"requests"};s.push(o),r.setState(function(e){return{resource_events:s}})}():i.includes("releases")?function(){var e=i.match(/p(\d+) releases r(\d+)/),t=parseInt(e[1]),n=parseInt(e[2]);console.log("Found resource release line: p"+t+" => r"+n);var s=U.cloneDeep(r.state.resource_events),o={process_id:t,resource_id:n,operation:"releases"};s.push(o),r.setState(function(e){return{resource_events:s}})}():console.log("ERROR: Found line which doesn't match standard.")}}catch(l){s=!0,o=l}finally{try{n||null==c.return||c.return()}finally{if(s)throw o}}};n.readAsText(t)},r.getNextProcessId=function(e){if(0===e.length)return 0;var t=0,r=!0,n=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var c=o.value;c.id>=t&&(t=c.id+1)}}catch(i){n=!0,s=i}finally{try{r||null==a.return||a.return()}finally{if(n)throw s}}return t},r.addProcess=function(e,t){var n=U.cloneDeep(r.state.processes);null===e&&(e=r.getNextProcessId(n)),null===t&&(t="unspecified");var s={id:e,name:t};n.push(s),r.setState(function(e){return{resources:n}})},r.removeProcess=function(e){if(null===e)return!1;var t=U.cloneDeep(r.state.processes),n={id:e};U.remove(t,n),r.setState(function(e){return{processes:t}})},r.checkForDeadlock=function(){var e=r.state.resources,t=!0,n=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(t=(o=a.next()).done);t=!0){var c=o.value;if(null!==c.owner&&r.cycleDetector(c.id,[],"p"+c.owner))return!0}}catch(i){n=!0,s=i}finally{try{t||null==a.return||a.return()}finally{if(n)throw s}}return!1},r.cycleDetector=function(e,t,n){if(console.log("Cycle Detecting: "+e),console.log("Cycle array: "+t),t>10)return!1;if(t.includes(n))return!0;var s=r.state.resources,o=s[e],a=!0,c=!1,i=void 0;try{for(var l,u=o.waiting[Symbol.iterator]();!(a=(l=u.next()).done);a=!0){var d=l.value,v=!0,h=!1,p=void 0;try{for(var f,m=s[Symbol.iterator]();!(v=(f=m.next()).done);v=!0){var g=f.value;if(g.owner===d){var y=t;if(y.push("p"+d),y.push("r"+g.id),y>10)return!0;if(console.log("Calling Cycle Detector"),r.cycleDetector(g.id,y,n))return!0}}}catch(w){h=!0,p=w}finally{try{v||null==m.return||m.return()}finally{if(h)throw p}}}}catch(w){c=!0,i=w}finally{try{a||null==u.return||u.return()}finally{if(c)throw i}}return!1},r.getResourceById=function(e,t){var r=!0,n=!1,s=void 0;try{for(var o,a=e[Symbol.iterator]();!(r=(o=a.next()).done);r=!0){var c=o.value;if(c.id===t)return c}}catch(i){n=!0,s=i}finally{try{r||null==a.return||a.return()}finally{if(n)throw s}}return null},r.handleRequestClick=function(e,t,n){var s=r.state.resources,o=r.getResourceById(s,t);if(null===o||-1===o)return console.log("ERROR: Resource ["+t+"] requested by process ["+e+"], but not present."),!1;o.waiting.includes(e)||o.owner===e?r.releaseResource(e,t):r.requestResource(e,t)},r.requestResource=function(e,t){var n=U.cloneDeep(r.state.resources),s=r.getResourceById(n,t),o=U.findIndex(r.state.resources,s);if(null===s||-1===o)return console.log("ERROR: Resource ["+t+"] requested, but not present."),!1;var a=s.owner,c=s.waiting;return console.log("Process "+e+" is requesting Resource "+t),null===a?(n[o].owner=e,console.log("Resource is free!"),r.setState(function(e){return{resources:n}}),!0):a!==e?c.includes(e)?(console.log("ERROR: Process duplicate resource request."),!1):(n[o].waiting.push(e),console.log("Process joining the wait queue..."),r.setState(function(e){return{resources:n}}),!1):void console.log("Process "+e+" requesting resource it already owns! ("+t+")")},r.releaseResource=function(e,t){var n=U.cloneDeep(r.state.resources),s=r.getResourceById(n,t),o=U.findIndex(r.state.resources,s);if(null===s||-1===o)return console.log("ERROR: Resource ["+t+"] requested, but not present."),!1;var a=s.owner,c=s.waiting;if(a===e){var i=c.shift();return n[o].owner=void 0===i?null:i,n[o].waiting=c,r.setState(function(e){return{resources:n}}),!0}return console.log("ERROR: Process("+e+") tried to release a resource("+s.id+") without ownership."),!1},r.state={processes:[],resources:[],resource_events:[],resource_history:[],resource_event_counter:-1},r}return Object(d.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=[],t=[],r=!0,n=!1,o=void 0;try{for(var a,c=this.state.resources[Symbol.iterator]();!(r=(a=c.next()).done);r=!0){var i=a.value;e.push(s.a.createElement(_,{id:i.id,name:i.name,owner:i.owner,waiting:i.waiting}))}}catch(y){n=!0,o=y}finally{try{r||null==c.return||c.return()}finally{if(n)throw o}}var l=!0,u=!1,d=void 0;try{for(var v,p=this.state.processes[Symbol.iterator]();!(l=(v=p.next()).done);l=!0){var m=v.value;t.push(s.a.createElement(O,{id:m.id,name:m.name,owner:m.owner,waiting:m.waiting,clickHandler:this.requestResource}))}}catch(y){u=!0,d=y}finally{try{l||null==p.return||p.return()}finally{if(u)throw d}}return s.a.createElement(h.a,{className:"full-display",container:!0,direction:"column",spacing:12},s.a.createElement(h.a,{className:"main-panel",container:!0,spacing:12},s.a.createElement(h.a,{item:!0,xs:3,xm:3,xl:3},s.a.createElement(f.a,null,s.a.createElement("div",{className:"instruction-panel"},s.a.createElement("div",{className:"instruction-file-section"},s.a.createElement(G,{fileChangeHandler:this.fileChangeHandler})),s.a.createElement(w.a,null),s.a.createElement("div",{className:"instruction-section"},s.a.createElement(C,{events:this.state.resource_events,clickHandler:this.goToEventNumber,eventCounter:this.state.resource_event_counter})),s.a.createElement(w.a,null),s.a.createElement(h.a,{container:!0,xs:12,spacing:12},s.a.createElement(h.a,{xs:6},s.a.createElement(g.a,{variant:"outlined",className:"instruction-nav-button",disabled:-1===this.state.resource_event_counter,onClick:this.prevEvent},"Previous")),s.a.createElement(h.a,{xs:6},s.a.createElement(g.a,{variant:"outlined",className:"instruction-nav-button",disabled:this.state.resource_event_counter===this.state.resource_events.length-1,onClick:this.nextEvent},-1===this.state.resource_event_counter?"Start":"Next")))))),s.a.createElement(h.a,{item:!0,xs:9,xm:9,xl:9},s.a.createElement(f.a,null,s.a.createElement("canvas",{id:"graph-space"}),s.a.createElement(I,{resources:this.state.resources,processes:this.state.processes})))),s.a.createElement(h.a,{className:"debug-panel",container:!0,spacing:12},s.a.createElement(h.a,{item:!0,xs:3},s.a.createElement(f.a,null,s.a.createElement("div",null,s.a.createElement("h2",null,this.checkForDeadlock()?"Deadlock found.":"No deadlock.")),s.a.createElement("div",null,s.a.createElement("h2",null,"Processes"),s.a.createElement(q,{processes:t})),s.a.createElement("div",null,s.a.createElement("h2",null,"Resources"),s.a.createElement(E,{resources:e})))),s.a.createElement(h.a,{item:!0,xs:9},s.a.createElement(f.a,null,s.a.createElement(J,{resources:e,processes:t,processOnClick:this.handleRequestClick})))))}}]),t}(s.a.Component);a.a.render(s.a.createElement($,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},34:function(e,t,r){},64:function(e,t,r){e.exports=r(170)}},[[64,2,1]]]);
//# sourceMappingURL=main.a9f91a97.chunk.js.map